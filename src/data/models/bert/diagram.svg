<svg xmlns="http://www.w3.org/2000/svg" width="800" height="3400" viewBox="0 0 800 3400"><defs><filter id="shadow" x="-0.16448728" y="-0.1325" width="1.3910452" height="1.315"><feGaussianBlur in="SourceAlpha" stdDeviation="2"/><feOffset dx="2" dy="2" result="offsetblur"/><feFlood flood-color="#000000" flood-opacity="0.06"/><feComposite in2="offsetblur" operator="in"/><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter><marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="#666"/></marker><marker id="arrow-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="#e57373"/></marker></defs><text x="400" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold">BERT for Masked Language Modeling</text><g class="component" data-component="input"><rect x="300" y="80" width="200" height="50" rx="25" fill="#ffd4d4" stroke="#666" stroke-width="1.5" filter="url(#shadow)"/><text x="400" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="15" font-weight="bold">Input Tokens</text></g><line x1="400" y1="130" x2="400" y2="180" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/><g class="component" data-component="bert-model"><rect x="100" y="180" width="605.40619" height="2749.332" rx="15" fill="#f5f0ff" stroke="#666666" stroke-width="1.5" filter="url(#shadow)"/><text x="400" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold">BertForMaskedLM</text><text x="400" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-style="italic">main</text></g><g class="component" data-component="bert"><rect x="130" y="260" width="542.87939" height="2075.5254" rx="12" fill="#ede6ff" stroke="#666666" stroke-width="1.2" stroke-dasharray="5, 3"/><text x="400" y="290" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold">BertModel</text><text x="400" y="308" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-style="italic">bert</text></g><g class="component" data-component="embeddings"><rect x="160" y="340" width="480" height="450" rx="10" fill="#e6d9ff" stroke="#666" stroke-width="1.2" filter="url(#shadow)"/><text x="400" y="370" text-anchor="middle" font-family="Arial, sans-serif" font-size="15" font-weight="bold">BertEmbeddings</text><text x="400" y="388" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-style="italic">embeddings</text></g><g class="component" data-component="word-embeddings"><rect x="180" y="410" width="140" height="60" rx="8" fill="#d4c5f9" stroke="#666" stroke-width="1" filter="url(#shadow)"/><text x="250" y="430" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Embedding</text><text x="250" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-style="italic">word_embeddings</text><text x="250" y="460" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">30522, 768</text></g><g class="component" data-component="token-type-embeddings"><rect x="330" y="410" width="140" height="60" rx="8" fill="#d4c5f9" stroke="#666" stroke-width="1" filter="url(#shadow)"/><text x="400" y="430" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Embedding</text><text x="400" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-style="italic">token_type_embeddings</text><text x="400" y="460" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">2, 768</text></g><g class="component" data-component="position-embeddings"><rect x="480" y="410" width="140" height="60" rx="8" fill="#d4c5f9" stroke="#666" stroke-width="1" filter="url(#shadow)"/><text x="550" y="430" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Embedding</text><text x="550" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-style="italic">position_embeddings</text><text x="550" y="460" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">512, 768</text></g><g class="component" data-component="sum"><circle cx="400" cy="510" r="20" fill="#ffd9b3" stroke="#666" stroke-width="1" filter="url(#shadow)"/><text x="400" y="517" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold">+</text></g><line x1="250" y1="470" x2="385" y2="495" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/><line x1="400" y1="470" x2="400" y2="490" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/><line x1="550" y1="470" x2="415" y2="495" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/><line x1="400" y1="530" x2="400" y2="570" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/><g class="component" data-component="embeddings-layernorm"><rect x="300" y="570" width="200" height="60" rx="22" fill="#d4e6b5" stroke="#666" stroke-width="1" filter="url(#shadow)"/><text x="400" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold">LayerNorm</text><text x="400" y="605" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-style="italic">LayerNorm</text><text x="400" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">[768], eps=1e-12</text></g><line x1="400" y1="630" x2="400" y2="670" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/><g class="component" data-component="embeddings-dropout"><rect x="300" y="670" width="200" height="60" rx="22" fill="#e6e0f5" stroke="#666" stroke-width="1" filter="url(#shadow)"/><text x="400" y="690" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Dropout</text><text x="400" y="705" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-style="italic">dropout</text><text x="400" y="720" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">p=0.1</text></g><line x1="400" y1="730" x2="400" y2="830" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/><g class="component" data-component="encoder"><rect x="160" y="830" width="478.5603" height="1439.6888" rx="10" fill="#e6d9ff" stroke="#666666" stroke-width="1.2" filter="url(#shadow)"/><text x="400" y="860" text-anchor="middle" font-family="Arial, sans-serif" font-size="15" font-weight="bold">BertEncoder</text><text x="400" y="878" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-style="italic">encoder</text></g><rect x="140" y="950" width="32.221336" height="1198.4792" rx="15" fill="#d4c5f9" stroke="#666666" stroke-width="1" filter="url(#shadow)"/><text x="155" y="1575" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" transform="rotate(-90 155 1575)">× 12 layers</text><g class="component" data-component="bert-layer"><rect x="190.00255" y="910.00256" width="417.36801" height="1284.0988" rx="9.9998789" fill="#ffe6d5" stroke="#666666" stroke-width="1.20508" stroke-dasharray="5, 3"/><text x="400" y="940" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">BertLayer</text></g><g class="component" data-component="attention"><rect x="210" y="970" width="377.78748" height="553.92548" rx="8" fill="#ffd9b3" stroke="#666666" stroke-width="1" filter="url(#shadow)"/><text x="400" y="995" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold">BertAttention</text><text x="400" y="1010" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">attention</text></g><g class="component" data-component="self-attention"><rect x="230" y="1030" width="340" height="220" rx="8" fill="#ffe6cc" stroke="#666" stroke-width="1"/><text x="400" y="1050" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">BertSdpaSelfAttention</text><text x="400" y="1065" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">self</text><text x="400" y="1080" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">num_attention_heads=12</text></g><g class="component" data-component="query"><rect x="240" y="1100" width="100" height="60" rx="8" fill="#cce5ff" stroke="#666" stroke-width="1"/><text x="290" y="1120" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Linear</text><text x="290" y="1135" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">query</text><text x="290" y="1150" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">768→768</text></g><g class="component" data-component="key"><rect x="350" y="1100" width="100" height="60" rx="8" fill="#cce5ff" stroke="#666" stroke-width="1"/><text x="400" y="1120" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Linear</text><text x="400" y="1135" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">key</text><text x="400" y="1150" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">768→768</text></g><g class="component" data-component="value"><rect x="460" y="1100" width="100" height="60" rx="8" fill="#cce5ff" stroke="#666" stroke-width="1"/><text x="510" y="1120" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Linear</text><text x="510" y="1135" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">value</text><text x="510" y="1150" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">768→768</text></g><g class="component" data-component="sdpa"><ellipse cx="400" cy="1200" rx="45" ry="18" fill="#ffd9b3" stroke="#666" stroke-width="1"/><text x="400" y="1205" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold">SDPA</text></g><line x1="290" y1="1160" x2="360" y2="1185" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/><line x1="400" y1="1160" x2="400" y2="1182" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/><line x1="510" y1="1160" x2="440" y2="1185" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/><line x1="400" y1="1218" x2="400" y2="1270" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/><g class="component" data-component="self-output"><rect x="230" y="1270" width="340" height="236.13802" rx="8" fill="#ffe6cc" stroke="#666666" stroke-width="1"/><text x="400" y="1290" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">BertSelfOutput</text><text x="400" y="1305" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">output</text></g><g class="component" data-component="attention-dense"><rect x="280" y="1320" width="240" height="45" rx="8" fill="#cce5ff" stroke="#666" stroke-width="1"/><text x="400" y="1334.1" text-anchor="middle" font-family="Arial, sans-serif" font-size="12px" font-weight="bold">Linear</text><text x="400" y="1347.1" text-anchor="middle" font-family="Arial, sans-serif" font-size="10px" font-style="italic">dense</text><text x="400" y="1359.1" text-anchor="middle" font-family="Arial, sans-serif" font-size="9px">768→768</text></g><line x1="400.36874" y1="1366.475" x2="400.36874" y2="1387.2125" stroke="#666666" stroke-width="1.01827" marker-end="url(#arrow)"/><g class="component" data-component="attention-dropout"><rect x="300" y="1386.4751" width="200" height="45" rx="20" fill="#e6e0f5" stroke="#666666" stroke-width="1"/><text x="400" y="1400.575" text-anchor="middle" font-family="Arial, sans-serif" font-size="12px" font-weight="bold">Dropout</text><text x="400" y="1413.575" text-anchor="middle" font-family="Arial, sans-serif" font-size="10px" font-style="italic">dropout</text><text x="400" y="1425.575" text-anchor="middle" font-family="Arial, sans-serif" font-size="9px">p=0.1</text></g><line x1="399.81671" y1="1434.8883" x2="399.81671" y2="1447.5132" stroke="#666666" stroke-width="0.794509" marker-end="url(#arrow)"/><g class="component" data-component="attention-layernorm"><rect x="300" y="1447.5377" width="200" height="45" rx="20" fill="#d4e6b5" stroke="#666666" stroke-width="1"/><text x="400" y="1467.5377" text-anchor="middle" font-family="Arial, sans-serif" font-size="12px" font-weight="bold">LayerNorm</text><text x="400" y="1480.5377" text-anchor="middle" font-family="Arial, sans-serif" font-size="10px" font-style="italic">LayerNorm</text></g><text x="520" y="1460.1626" font-family="Arial, sans-serif" font-size="10px" fill="#e57373">+ residual</text><line x1="400.73752" y1="1496.6376" x2="400.73752" y2="1555.8129" stroke="#666666" stroke-width="1.82445" marker-end="url(#arrow)"/><g class="component" data-component="intermediate"><rect x="210" y="1556.5504" width="380" height="220" rx="8" fill="#e0f2f1" stroke="#666666" stroke-width="1" filter="url(#shadow)"/><text x="400" y="1577.8628" text-anchor="middle" font-family="Arial, sans-serif" font-size="13px" font-weight="bold">BertIntermediate</text><text x="400" y="1592.8628" text-anchor="middle" font-family="Arial, sans-serif" font-size="10px" font-style="italic">intermediate</text></g><g class="component" data-component="intermediate-dense"><rect x="260" y="1616.5504" width="280" height="60" rx="8" fill="#cce5ff" stroke="#666666" stroke-width="1"/><text x="400" y="1636.5504" text-anchor="middle" font-family="Arial, sans-serif" font-size="12px" font-weight="bold">Linear</text><text x="400" y="1651.5504" text-anchor="middle" font-family="Arial, sans-serif" font-size="10px" font-style="italic">dense</text><text x="400" y="1666.5504" text-anchor="middle" font-family="Arial, sans-serif" font-size="9px">768→3072</text></g><line x1="400" y1="1676.5504" x2="400" y2="1706.5504" stroke="#666666" stroke-width="1.2" marker-end="url(#arrow)"/><g class="component" data-component="gelu"><rect x="300" y="1706.5504" width="200" height="50" rx="22" fill="#ffe0b3" stroke="#666666" stroke-width="1"/><text x="400" y="1726.5504" text-anchor="middle" font-family="Arial, sans-serif" font-size="12px" font-weight="bold">GELUActivation</text><text x="400" y="1741.5504" text-anchor="middle" font-family="Arial, sans-serif" font-size="10px" font-style="italic">intermediate_act_fn</text></g><line x1="400" y1="1759.5004" x2="400" y2="1800" stroke="#666666" stroke-width="1.5" marker-end="url(#arrow)"/><g class="component" data-component="output"><rect x="210" y="1800" width="380" height="345.91428" rx="8" fill="#e0f2f1" stroke="#666666" stroke-width="1" filter="url(#shadow)"/><text x="400" y="1825" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold">BertOutput</text><text x="400" y="1840" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">output</text></g><g class="component" data-component="output-dense"><rect x="260" y="1860" width="280" height="60" rx="8" fill="#cce5ff" stroke="#666" stroke-width="1"/><text x="400" y="1880" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Linear</text><text x="400" y="1895" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">dense</text><text x="400" y="1910" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">3072→768</text></g><line x1="400" y1="1920" x2="400" y2="1950" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/><g class="component" data-component="output-dropout"><rect x="300" y="1950" width="200" height="60" rx="22" fill="#e6e0f5" stroke="#666" stroke-width="1"/><text x="400" y="1970" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Dropout</text><text x="400" y="1985" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">dropout</text><text x="400" y="2000" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">p=0.1</text></g><line x1="400" y1="2010" x2="400" y2="2040" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/><g class="component" data-component="output-layernorm"><rect x="300" y="2040" width="200" height="60" rx="22" fill="#d4e6b5" stroke="#666" stroke-width="1"/><text x="400" y="2060" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">LayerNorm</text><text x="400" y="2075" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">LayerNorm</text><text x="400" y="2090" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">[768], eps=1e-12</text></g><text x="513.59943" y="2057.99" font-family="Arial, sans-serif" font-size="10px" fill="#e57373">+ residual</text><path d="m 586.94229,1446.42 h 53.0625 v 626.0759 H 533.8798" stroke="#e57373" stroke-width="2.17077" stroke-dasharray="5, 3" fill="none" marker-end="url(#arrow-red)"/><path d="m 599.99188,1200.0293 h 59.94872 v 273.0801 H 520.06026" stroke="#e57373" stroke-width="2.08939" stroke-dasharray="5, 3" fill="none" marker-end="url(#arrow-red)"/><line x1="400" y1="2276.8875" x2="400" y2="2400" stroke="#666666" stroke-width="2.94221" marker-end="url(#arrow)"/><g class="component" data-component="mlm-head"><rect x="130.12629" y="2400.143" width="539.73474" height="506.08841" rx="11.994105" fill="#ede6ff" stroke="#666666" stroke-width="1.46369" stroke-dasharray="5, 3"/><text x="400" y="2430" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold">BertOnlyMLMHead</text><text x="400" y="2448" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-style="italic">cls</text></g><g class="component" data-component="predictions"><rect x="160.29909" y="2470.881" width="479.55676" height="404.88644" rx="13.689594" fill="#e6d9ff" stroke="#666666" stroke-width="1.64284" filter="url(#shadow)"/><text x="400" y="2505" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">BertLMPredictionHead</text><text x="400" y="2520" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">predictions</text></g><g class="component" data-component="transform"><rect x="180.05219" y="2540.0522" width="439.89563" height="243.98735" rx="7.9981022" fill="#f0e6ff" stroke="#666666" stroke-width="1"/><text x="400" y="2560" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">BertPredictionHeadTransform</text><text x="400" y="2575" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">transform</text></g><g class="component" data-component="transform-dense"><g transform="translate(0.15729825,-9.011611)"><rect x="280.89642" y="2596.0251" width="240" height="45" rx="8" fill="#cce5ff" stroke="#666666" stroke-width="1"/><text x="400" y="2610" text-anchor="middle" font-family="Arial, sans-serif" font-size="12px" font-weight="bold">Linear</text><text x="400" y="2623" text-anchor="middle" font-family="Arial, sans-serif" font-size="10px" font-style="italic">dense</text><text x="400" y="2635" text-anchor="middle" font-family="Arial, sans-serif" font-size="9px">768→768</text></g></g><line x1="400" y1="2635" x2="400" y2="2655" stroke="#666" stroke-width="1" marker-end="url(#arrow)"/><g class="component" data-component="transform-gelu"><rect x="300" y="2655" width="200" height="45" rx="20" fill="#ffe0b3" stroke="#666" stroke-width="1"/><text x="400" y="2675" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">GELUActivation</text><text x="400" y="2688" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">transform_act_fn</text></g><line x1="400" y1="2700" x2="400" y2="2720" stroke="#666" stroke-width="1" marker-end="url(#arrow)"/><g class="component" data-component="transform-layernorm"><rect x="300" y="2720" width="200" height="45" rx="20" fill="#d4e6b5" stroke="#666" stroke-width="1"/><text x="400" y="2740" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">LayerNorm</text><text x="400" y="2753" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic">LayerNorm</text></g><line x1="400" y1="2766.6055" x2="400" y2="2800.0432" stroke="#666666" stroke-width="1.89599" marker-end="url(#arrow)"/><g class="component" data-component="decoder"><g transform="translate(-9.5235287,-28.210899)"><rect x="256.1123" y="2833.8035" width="300" height="50" rx="8" fill="#cce5ff" stroke="#666666" stroke-width="1"/><text x="406.17151" y="2865.4121" text-anchor="middle" font-family="Arial, sans-serif" font-size="10px" font-style="italic">decoder</text><text x="406.17151" y="2850.4121" text-anchor="middle" font-family="Arial, sans-serif" font-size="12px" font-weight="bold">Linear</text><text x="406.17151" y="2878.4121" text-anchor="middle" font-family="Arial, sans-serif" font-size="9px">768→30522</text></g></g><line x1="394.9462" y1="2861.9536" x2="394.9462" y2="2960.0073" stroke="#666666" stroke-width="2.36708" marker-end="url(#arrow)"/><g class="component" data-component="output-logits"><g transform="translate(-8.4996932,27.896302)"><rect x="301.42581" y="2933.0776" width="200" height="50" rx="25" fill="#c8f5c8" stroke="#666666" stroke-width="1.5" filter="url(#shadow)"/><text x="403.7052" y="2954.2361" text-anchor="middle" font-family="Arial, sans-serif" font-size="15px" font-weight="bold">Output Logits</text><text x="403.7052" y="2969.2361" text-anchor="middle" font-family="Arial, sans-serif" font-size="11px">30522 vocab predictions</text></g></g></svg>
