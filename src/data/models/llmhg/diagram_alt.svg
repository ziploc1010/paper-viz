<svg viewBox="0 0 900 1400" xmlns="http://www.w3.org/2000/svg">
  <!-- Define styles matching the reference palette -->
  <defs>
    <filter id="shadow">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.2"/>
    </filter>
  </defs>
  
  <!-- Main container with light purple background -->
  <rect x="50" y="20" width="800" height="1350" rx="20" fill="#E8E0F5" stroke="#8B7BA8" stroke-width="2" filter="url(#shadow)"/>
  
  <!-- Title -->
  <text x="450" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#2C2C2C">
    LLMHG Model Architecture
  </text>
  
  <!-- Input Tokens - Pink rounded -->
  <g class="component" data-component="input">
    <rect x="275" y="100" width="350" height="50" rx="25" fill="#FFE0E6" stroke="#FF8FA3" stroke-width="2"/>
    <text x="450" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Input Tokens</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 450 150 L 450 180" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <polygon points="450,185 445,175 455,175" fill="#5A5A5A"/>
  
  <!-- Main Model Container -->
  <g class="component" data-component="llmhg">
    <rect x="100" y="190" width="700" height="1070" rx="15" fill="#F0E8FF" stroke="#A090D0" stroke-width="2"/>
    <text x="450" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold">LLMHG</text>
  </g>
  
  <!-- Embedding -->
  <g class="component" data-component="embedding">
    <rect x="200" y="250" width="500" height="60" rx="10" fill="#E0D0F5" stroke="#9080B0" stroke-width="2"/>
    <text x="450" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Embedding</text>
    <text x="450" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#666">item_embedding</text>
  </g>
  
  <!-- Arrow splits to two paths -->
  <path d="M 450 310 L 450 340" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <path d="M 450 340 L 250 370" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <path d="M 450 340 L 650 370" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <polygon points="250,375 255,365 245,365" fill="#5A5A5A"/>
  <polygon points="650,375 645,365 655,365" fill="#5A5A5A"/>
  
  <!-- GRU -->
  <g class="component" data-component="gru">
    <rect x="150" y="380" width="200" height="60" rx="10" fill="#C8E8C8" stroke="#90C890" stroke-width="2"/>
    <text x="250" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">GRU</text>
    <text x="250" y="425" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#666">gru_out</text>
  </g>
  
  <!-- Arrow from GRU splits -->
  <path d="M 250 440 L 250 470" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <path d="M 250 470 L 180 500" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <path d="M 250 470 L 320 500" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <polygon points="180,505 185,495 175,495" fill="#5A5A5A"/>
  <polygon points="320,505 315,495 325,495" fill="#5A5A5A"/>
  
  <!-- Label for last_hidden extraction -->
  <text x="290" y="465" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#666" font-style="italic">extract last</text>
  
  <!-- W1 -->
  <g class="component" data-component="w1">
    <rect x="120" y="510" width="120" height="50" rx="10" fill="#B3D9E6" stroke="#6FA8C8" stroke-width="2"/>
    <text x="180" y="530" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Linear</text>
    <text x="180" y="545" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#555">W1 → q1</text>
  </g>
  
  <!-- W2 -->
  <g class="component" data-component="w2">
    <rect x="260" y="510" width="120" height="50" rx="10" fill="#B3D9E6" stroke="#6FA8C8" stroke-width="2"/>
    <text x="320" y="530" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Linear</text>
    <text x="320" y="545" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#555">W2 → q2</text>
  </g>
  
  <!-- Arrows converge to v -->
  <path d="M 180 560 L 180 590 L 230 590" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <path d="M 320 560 L 320 590 L 270 590" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <polygon points="235,590 225,585 225,595" fill="#5A5A5A"/>
  <polygon points="265,590 275,585 275,595" fill="#5A5A5A"/>
  
  <!-- v -->
  <g class="component" data-component="v">
    <rect x="190" y="570" width="120" height="50" rx="10" fill="#B3D9E6" stroke="#6FA8C8" stroke-width="2"/>
    <text x="250" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Linear</text>
    <text x="250" y="605" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#555">v → alpha</text>
  </g>
  
  <!-- Arrow from v and gru_out to sum -->
  <path d="M 250 620 L 250 650" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <path d="M 150 440 L 150 680 L 220 680" stroke="#5A5A5A" stroke-width="1" stroke-dasharray="3,3" fill="none"/>
  <text x="120" y="560" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666" font-style="italic">gru_out</text>
  <polygon points="250,655 245,645 255,645" fill="#5A5A5A"/>
  <polygon points="225,680 215,675 215,685" fill="#5A5A5A"/>
  
  <!-- sum -->
  <g class="component" data-component="sum">
    <rect x="190" y="660" width="120" height="50" rx="10" fill="#A8D8A8" stroke="#70A870" stroke-width="2"/>
    <text x="250" y="685" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">sum</text>
    <text x="250" y="700" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#555">session_emb</text>
  </g>
  
  <!-- Multi-View Hypergraphs Container -->
  <rect x="450" y="380" width="300" height="400" rx="10" fill="#FFE8CC" stroke="#D4A574" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="600" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Multi-View Hypergraphs</text>
  
  <!-- build_hypergraphs -->
  <g class="component" data-component="build-hypergraphs">
    <rect x="470" y="430" width="260" height="40" rx="5" fill="#FFD8AA" stroke="#C49050" stroke-width="2"/>
    <text x="600" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">build_hypergraphs</text>
  </g>
  
  <!-- Arrow from build_hypergraphs to three H_ components -->
  <path d="M 600 470 L 510 500" stroke="#5A5A5A" stroke-width="1" fill="none"/>
  <path d="M 600 470 L 600 500" stroke="#5A5A5A" stroke-width="1" fill="none"/>
  <path d="M 600 470 L 690 500" stroke="#5A5A5A" stroke-width="1" fill="none"/>
  <polygon points="510,505 515,495 505,495" fill="#5A5A5A"/>
  <polygon points="600,505 595,495 605,495" fill="#5A5A5A"/>
  <polygon points="690,505 685,495 695,495" fill="#5A5A5A"/>
  
  <!-- Three Hypergraph Incidence Matrices -->
  <g class="component" data-component="h-cooccur">
    <rect x="470" y="510" width="80" height="50" rx="5" fill="#FFD8AA" stroke="#C49050" stroke-width="2"/>
    <text x="510" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold">H_cooccur</text>
  </g>
  
  <g class="component" data-component="h-sequential">
    <rect x="560" y="510" width="80" height="50" rx="5" fill="#FFD8AA" stroke="#C49050" stroke-width="2"/>
    <text x="600" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold">H_sequential</text>
  </g>
  
  <g class="component" data-component="h-semantic">
    <rect x="650" y="510" width="80" height="50" rx="5" fill="#FFD8AA" stroke="#C49050" stroke-width="2"/>
    <text x="690" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold">H_semantic</text>
  </g>
  
  <!-- Arrows from H_ to HypergraphConvolution -->
  <path d="M 510 560 L 510 590" stroke="#5A5A5A" stroke-width="1" fill="none"/>
  <path d="M 600 560 L 600 590" stroke="#5A5A5A" stroke-width="1" fill="none"/>
  <path d="M 690 560 L 690 590" stroke="#5A5A5A" stroke-width="1" fill="none"/>
  <polygon points="510,595 505,585 515,585" fill="#5A5A5A"/>
  <polygon points="600,595 595,585 605,585" fill="#5A5A5A"/>
  <polygon points="690,595 685,585 695,585" fill="#5A5A5A"/>
  
  <!-- HypergraphConvolution -->
  <g class="component" data-component="hypergraph-convolution">
    <rect x="470" y="600" width="260" height="80" rx="5" fill="#FFCC99" stroke="#C49050" stroke-width="2"/>
    <text x="600" y="630" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold">HypergraphConvolution</text>
    <text x="600" y="650" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">hgnn_layers</text>
    <text x="600" y="665" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">[3 layers per view]</text>
  </g>
  
  <!-- Arrow from HypergraphConvolution -->
  <path d="M 600 680 L 600 710" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <polygon points="600,715 595,705 605,705" fill="#5A5A5A"/>
  
  <!-- view_embeddings -->
  <g class="component" data-component="view-embeddings">
    <rect x="470" y="720" width="260" height="50" rx="10" fill="#FFE6F0" stroke="#FF99CC" stroke-width="2"/>
    <text x="600" y="750" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold">view_embeddings</text>
    <text x="600" y="762" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">[3 view tensors]</text>
  </g>
  
  <!-- Arrows converging to MultiViewAttention -->
  <path d="M 250 710 L 250 830 L 380 830" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <path d="M 600 770 L 600 830 L 520 830" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <!-- last_hidden arrow from GRU area -->
  <path d="M 350 470 L 400 470 L 400 800 L 450 800" stroke="#5A5A5A" stroke-width="1" stroke-dasharray="3,3" fill="none"/>
  <text x="410" y="635" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#666" font-style="italic">last_hidden</text>
  <polygon points="385,830 375,825 375,835" fill="#5A5A5A"/>
  <polygon points="515,830 525,825 525,835" fill="#5A5A5A"/>
  <polygon points="455,800 445,795 445,805" fill="#5A5A5A"/>
  
  <!-- MultiViewAttention -->
  <g class="component" data-component="multiview-attention">
    <rect x="200" y="800" width="500" height="60" rx="10" fill="#B3D9E6" stroke="#6FA8C8" stroke-width="2"/>
    <text x="450" y="830" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">MultiViewAttention</text>
    <text x="450" y="845" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">view_attention → combined_view_emb</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 450 860 L 450 890" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <polygon points="450,895 445,885 455,885" fill="#5A5A5A"/>
  
  <!-- cat -->
  <g class="component" data-component="cat">
    <rect x="220" y="900" width="460" height="60" rx="10" fill="#E0D0F5" stroke="#9080B0" stroke-width="2"/>
    <text x="450" y="930" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">cat</text>
    <text x="450" y="945" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">[session_emb, combined_view_emb]</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 450 960 L 450 990" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <polygon points="450,995 445,985 455,985" fill="#5A5A5A"/>
  
  <!-- Linear (W_final) -->
  <g class="component" data-component="w-final">
    <rect x="270" y="1000" width="360" height="60" rx="10" fill="#B3CCE6" stroke="#6F8FB8" stroke-width="2"/>
    <text x="450" y="1025" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Linear</text>
    <text x="450" y="1040" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#555">W_final</text>
  </g>
  
  <!-- Arrow -->
  <path d="M 450 1060 L 450 1090" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <polygon points="450,1095 445,1085 455,1085" fill="#5A5A5A"/>
  
  <!-- Linear (output_layer) -->
  <g class="component" data-component="output-layer">
    <rect x="270" y="1100" width="360" height="60" rx="10" fill="#B3CCE6" stroke="#6F8FB8" stroke-width="2"/>
    <text x="450" y="1125" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Linear</text>
    <text x="450" y="1140" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#555">output_layer</text>
  </g>
  
  <!-- Arrow out of main container -->
  <path d="M 450 1260 L 450 1290" stroke="#5A5A5A" stroke-width="2" fill="none"/>
  <polygon points="450,1295 445,1285 455,1285" fill="#5A5A5A"/>
  
  <!-- Output Logits -->
  <g class="component" data-component="output-logits">
    <rect x="275" y="1300" width="350" height="50" rx="25" fill="#C8E8C8" stroke="#90C890" stroke-width="2"/>
    <text x="450" y="1330" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Output Logits</text>
  </g>
  
  <!-- Legend -->
  <rect x="650" y="1320" width="150" height="20" rx="5" fill="#FFE8CC" stroke="#D4A574" stroke-width="1" stroke-dasharray="3,3"/>
  <text x="725" y="1335" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Optional components</text>
</svg>
